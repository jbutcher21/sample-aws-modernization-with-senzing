+++
title = "Stage 4: MAPPING"
weight = 634
+++

## Stage 4: Field-by-Field Mapping Decisions

This is the core mapping stage where every field gets a disposition: **Feature** (used for matching), **Payload** (stored but not matched), or **Ignored** (not needed).

{{% notice warning %}}**This is where your domain expertise matters most.** The AI can suggest mappings based on Senzing patterns, but you need to verify they make business sense for your use case.]{type="info"}

---

## Your Prompt

```bash
Show me the full mapping table for all 31 fields
```

Or:
```bash
Proceed to Stage 4: Map each field to Senzing format
```

---

## AI Response: Initial Mapping Table

The AI presents a complete mapping table. Here's the summary:

### Summary Counts

- **Features:** 18 fields mapped to Senzing matching features
- **Payload:** 6 fields mapped to payload attributes (stored, not matched)
- **Ignored:** 7 fields (containers, pointers, type indicators)

---

## Key Mapping Decisions

### Person Entity Features

| Source Field | Senzing Feature | Notes |
|--------------|-----------------|-------|
| `firstName` | `NAME_FIRST` | Standard name feature |
| `middleName` | `NAME_MIDDLE` | Standard name feature |
| `lastName` | `NAME_LAST` | Standard name feature |
| `name` (full) | `NAME_FULL` | When first/middle/last not available |
| `alias` | `NAME_FULL` (usage: ALIAS) | Known aliases |
| `previousName` | `NAME_FULL` (usage: MAIDEN) | Former names |
| `birthDate` | `DATE_OF_BIRTH` | Standard demographic |
| `gender` | `GENDER` | Standard demographic |
| `address` | `ADDR_FULL` | Full address strings |
| `email` | `EMAIL_ADDRESS` | Contact feature |
| `phone` | `PHONE_NUMBER` | Contact feature |
| `passportNumber` | `PASSPORT_NUMBER` + `PASSPORT_COUNTRY` | Identifier feature |
| `idNumber` | `NATIONAL_ID_NUMBER` + `NATIONAL_ID_COUNTRY` | Identifier feature |
| `taxNumber` | `TAX_ID_NUMBER` + `TAX_ID_COUNTRY` | Identifier feature |

### Company Entity Features

| Source Field | Senzing Feature | Notes |
|--------------|-----------------|-------|
| `name` | `NAME_ORG` | Organization name |
| `previousName` | `NAME_ORG` (usage: PRIOR) | **CORRECTED** (see below) |
| `jurisdiction` | `ADDR_COUNTRY` | Country of incorporation |
| `incorporationDate` | *(Payload)* | See discussion below |

### Payload Attributes (Not Used for Matching)

| Source Field | Payload Attribute | Reason |
|--------------|-------------------|--------|
| `nationality` | `NATIONALITY` | Operational data |
| `country` | `COUNTRY` | Operational data |
| `weakAlias` | `WEAK_ALIAS` | Low confidence, don't match on it |
| `incorporationDate` | `INCORPORATION_DATE` | Operational data |
| Sanction fields | `SANCTION_*` | Metadata merged onto Person entities |

### Relationship Handling

**Ownership and Directorship records:**
- Not mapped to features or payload
- Converted to `REL_POINTER` relationships in mapper code
- Roles: `OWNER_OF`, `PRINCIPAL_OF`, `PRESIDENT_OF`

---

## Interactive Corrections

During this stage, several important corrections were made based on questions and data verification:

### Correction 1: Identifier Types

**Your Question:**
```bash
Are you sure those are all the identifier types, and how do you know?
```

**AI Initial Response:**
```
I assumed based on the schema fields (passportNumber, idNumber, taxNumber).
```

**Your Challenge:**
```
You should check the actual source data, not just the schema.
```

**AI Verification:**
After checking actual FTM records, the AI found **nested identifier records**:
- **1 Driver's License record** → Maps to `DRIVERS_LICENSE_NUMBER` + `DRIVERS_LICENSE_STATE`
- **2 SSN records** → Maps to `SSN_NUMBER`

{{% notice info %}}**Critical Lesson**: Always verify AI assumptions against actual data! The schema showed general identifier fields (`idNumber`, `passportNumber`), but nested identifier records had specific types that required different Senzing features.{{% /notice %}}

---

### Correction 2: Company Relationships

**Your Question:**
```bash
I didn't see any rel_pointers in the json examples, don't companies have relationships as well?
```

**AI Initial Response:**
```
Ownership records show owner→asset (person owning company). I didn't check company→company ownership.
```

**Your Discovery:**
After checking actual data, you found:
- **Universal Exports Worldwide** owns 3 subsidiary companies
- Company-to-company ownership relationships exist
- All use `REL_POINTER_ROLE = "OWNER_OF"`

{{% notice warning %}}**Key Learning**: Don't assume relationship patterns. Check actual data to find all variations:
- Person → Company (directorship)
- Person → Company (ownership)
- Company → Company (ownership){{% /notice %}}

---

### Correction 3: Relationship Roles

**Your Question:**
```bash
What are my options for assigning roles to relationship pointers?
```

**AI Response:**
Based on the Senzing specification, standard roles include:

**Person ↔ Organization:**
- `EMPLOYED_BY`
- `PRINCIPAL_OF`
- `OWNER_OF`
- `DIRECTOR_OF`

**Organization ↔ Organization:**
- `BRANCH_OF`
- `DIRECT_PARENT`
- `ULTIMATE_PARENT`

**Your Decision:**
```bash
Use PRINCIPAL_OF for principals and PRESIDENT_OF for presidents
```

**Final Role Mappings:**
- All Ownership → `"OWNER_OF"`
- Directorship with role="Principal" → `"PRINCIPAL_OF"`
- Directorship with role="President" → `"PRESIDENT_OF"`

{{% notice info %}}**Role Precision**: Using specific roles (`PRESIDENT_OF` vs generic `DIRECTOR_OF`) provides better relationship clarity and supports more precise network analysis.{{% /notice %}}

---

### Correction 4: Previous Names for Organizations

**Your Correction:**
```bash
previous name should be name_org, not name_full
```

**AI Response:**
```
You're absolutely right! For organizations, previous names should use NAME_ORG, not NAME_FULL.
NAME_FULL is for person names.
```

**Corrected Mapping:**
- Company `previousName` → `NAME_ORG` with usage type `PRIOR`

{{% notice info %}}**Senzing Convention**: `NAME_FULL` is for people, `NAME_ORG` is for organizations. Using the wrong feature can degrade matching quality.{{% /notice %}}

---

### Question 5: Company Identifiers

**Your Question:**
```bash
Aren't there any identifiers for companies?
```

**AI Response:**
After checking the actual FTM data, no company identifier fields were found in this dataset. Companies only have:
- Organization name
- Previous names
- Jurisdiction (country)
- Incorporation date

::alert[**Dataset-Specific**: Not all datasets have all field types. This watchlist happens to lack company identifiers (tax IDs, registration numbers). Other datasets might include them.{{% /notice %}}

---

## Complete Mapping Table

Here's the final mapping table after all corrections:

### Person Entities (SANCTIONS)

| FTM Field | Senzing Disposition | Feature/Attribute | Usage Type |
|-----------|---------------------|-------------------|------------|
| `id` | Required | `RECORD_ID` | - |
| `schema` | Required | `RECORD_TYPE = "PERSON"` | - |
| `firstName` | Feature | `NAME_FIRST` | - |
| `middleName` | Feature | `NAME_MIDDLE` | - |
| `lastName` | Feature | `NAME_LAST` | - |
| `name` | Feature | `NAME_FULL` | - |
| `alias` | Feature | `NAME_FULL` | ALIAS |
| `previousName` | Feature | `NAME_FULL` | MAIDEN |
| `birthDate` | Feature | `DATE_OF_BIRTH` | - |
| `gender` | Feature | `GENDER` | - |
| `address` | Feature | `ADDR_FULL` | - |
| `email` | Feature | `EMAIL_ADDRESS` | - |
| `phone` | Feature | `PHONE_NUMBER` | - |
| `passportNumber` | Feature | `PASSPORT_NUMBER` + `PASSPORT_COUNTRY` | - |
| `idNumber` | Feature | `NATIONAL_ID_NUMBER` + `NATIONAL_ID_COUNTRY` | - |
| `taxNumber` | Feature | `TAX_ID_NUMBER` + `TAX_ID_COUNTRY` | - |
| `nationality` | Payload | `NATIONALITY` | - |
| `country` | Payload | `COUNTRY` | - |
| `weakAlias` | Payload | `WEAK_ALIAS` | - |
| **Nested Identifiers** | | | |
| SSN identifier | Feature | `SSN_NUMBER` | - |
| Driver's License | Feature | `DRIVERS_LICENSE_NUMBER` + `DRIVERS_LICENSE_STATE` | - |
| **Merged Sanctions** | | | |
| `program` | Payload | `SANCTION_PROGRAM` | - |
| `authority` | Payload | `SANCTION_AUTHORITY` | - |
| `reason` | Payload | `SANCTION_REASON` | - |
| `listingDate` | Payload | `SANCTION_LISTING_DATE` | - |
| `status` | Payload | `SANCTION_STATUS` | - |
| **Relationships** | | | |
| REL_ANCHOR | Feature | `REL_ANCHOR_DOMAIN` + `REL_ANCHOR_KEY` | - |
| Ownership/Directorship | Feature | `REL_POINTER_DOMAIN` + `REL_POINTER_KEY` + `REL_POINTER_ROLE` | - |

### Company Entities (CORP_FILINGS)

| FTM Field | Senzing Disposition | Feature/Attribute | Usage Type |
|-----------|---------------------|-------------------|------------|
| `id` | Required | `RECORD_ID` | - |
| `schema` | Required | `RECORD_TYPE = "ORGANIZATION"` | - |
| `name` | Feature | `NAME_ORG` | - |
| `previousName` | Feature | `NAME_ORG` | PRIOR |
| `jurisdiction` | Feature | `ADDR_COUNTRY` | - |
| `incorporationDate` | Payload | `INCORPORATION_DATE` | - |
| **Relationships** | | | |
| REL_ANCHOR | Feature | `REL_ANCHOR_DOMAIN` + `REL_ANCHOR_KEY` | - |
| Ownership | Feature | `REL_POINTER_DOMAIN` + `REL_POINTER_KEY` + `REL_POINTER_ROLE` | - |

---

## Validation Checkpoint

Before proceeding to Stage 5, verify:

- ✅ All 31 fields have a disposition (Feature, Payload, or Ignored)
- ✅ Identifier types verified against actual data (not just schema)
- ✅ Company relationship patterns identified
- ✅ Relationship roles assigned (OWNER_OF, PRINCIPAL_OF, PRESIDENT_OF)
- ✅ NAME_ORG used for organization names (not NAME_FULL)
- ✅ REL_ANCHOR and REL_POINTER strategy defined

---

## Key Learnings from This Stage

### 1. Verify Assumptions
The AI will make reasonable assumptions, but **always verify against actual data**:
- Identifier types weren't in the schema fields - they were in nested records
- Company-to-company relationships weren't obvious until checking the data

### 2. Domain Knowledge Matters
You caught important errors that would have degraded matching:
- NAME_ORG vs NAME_FULL for organizations
- Specific relationship roles vs generic ones

### 3. Interactive Mapping is Best
This wasn't a one-shot prompt. It was an **interactive dialogue**:
- AI proposed mappings
- You questioned assumptions
- AI verified against data
- You confirmed or corrected
- Repeat until mapping is complete

This produces much higher quality mappings than asking AI to "just do it all."

---

## Next Stage

With field mappings finalized, proceed to **Stage 5: OUTPUTS** where the AI generates mapper code, documentation, and sample JSON.

**[Continue to Stage 5: OUTPUTS →](../635_mapoutputs/)**
